const express = require('express');
const app = express();
const port = 3000;

// Dữ liệu chứng khoán mẫu
const stockData = [
  {
    "symbol": "A32",
    "StockId": "77800",
    "FullName": "CTCP 32",
    "tradingdate": "19/09/2024",
    "FloorCode": "04",
    "StockType": "2",
    "ceiling": 38900,
    "floor": 28900,
    "reference": 33900,
    "bidPrice3": 31800,
    "bidVol3": 1500,
    "bidPrice2": 33300,
    "bidVol2": 500,
    "bidPrice1": "33400",
    "bidVol1": 300,
    "closePrice": 0,
    "closeVol": 0,
    "change": 0,
    "offerPrice1": "34200",
    "offerVol1": 200,
    "offerPrice2": 34500,
    "offerVol2": 300,
    "offerPrice3": 38800,
    "offerVol3": 1700,
    "totalTrading": 0,
    "totalTradingValue": 0,
    "open": 0,
    "high": 0,
    "low": 0,
    "foreignBuy": 0,
    "foreignSell": 0,
    "foreignRemain": 0,
    "TOTAL_OFFER_QTTY": 2200,
    "TOTAL_BID_QTTY": 6600,
    "PT_MATCH_PRICE": 0,
    "PT_TOTAL_TRADED_QTTY": 0,
    "PT_TOTAL_TRADED_VALUE": 0,
    "Status": "0|0|0|0|0",
    "TotalListingQtty": "6800000",
    "changePercent": 0,
    "exchange": "UPCOM",
    "ts": 1726732912708,
    "s": 113,
    "kid": "17267329127091507148002241497039"
},
{
    "symbol": "AAA",
    "StockId": "21",
    "FullName": "Công ty cổ phần Nhựa An Phát Xanh",
    "tradingdate": "19/09/2024",
    "FloorCode": "10",
    "StockType": "2",
    "ceiling": 10450,
    "floor": 9120,
    "reference": 9800,
    "bidPrice3": 9790,
    "bidVol3": 24000,
    "bidPrice2": 9800,
    "bidVol2": 80500,
    "bidPrice1": "9810",
    "bidVol1": 4000,
    "closePrice": 9810,
    "closeVol": 49000,
    "change": 10,
    "offerPrice1": "9820",
    "offerVol1": 66700,
    "offerPrice2": 9830,
    "offerVol2": 12400,
    "offerPrice3": 9840,
    "offerVol3": 47600,
    "totalTrading": 1243800,
    "totalTradingValue": 12222429000,
    "averagePrice": 9826.68355041003,
    "open": 9840,
    "high": 9880,
    "low": 9800,
    "foreignBuy": 15600,
    "foreignSell": 1600,
    "foreignRemain": 374209826,
    "foreignRoom": 382274496,
    "Status": "|||||||H",
    "underlyingSymbol": "",
    "IssuerName": "",
    "CoveredWarrantType": "",
    "MaturityDate": "",
    "ExercisePrice": "0",
    "ListedShare": "382274496",
    "FundType": "S",
    "changePercent": 0.10204081632653061,
    "exchange": "HOSE",
    "ts": 1726734572380,
    "s": 1493,
    "kid": "1726734572380997444621461782516"
},
{
    "symbol": "AAH",
    "StockId": "82167",
    "FullName": "CTCP Hop nhat",
    "tradingdate": "19/09/2024",
    "FloorCode": "04",
    "StockType": "2",
    "ceiling": 4400,
    "floor": 3400,
    "reference": 3900,
    "bidPrice3": 3800,
    "bidVol3": 405000,
    "bidPrice2": 3900,
    "bidVol2": 1186500,
    "bidPrice1": "4000",
    "bidVol1": 448400,
    "closePrice": 4100,
    "closeVol": 5000,
    "change": 200,
    "offerPrice1": "4100",
    "offerVol1": 440100,
    "offerPrice2": 4200,
    "offerVol2": 760400,
    "offerPrice3": 4300,
    "offerVol3": 496300,
    "totalTrading": 3145900,
    "totalTradingValue": 12729450000,
    "averagePrice": 4046.36193140278,
    "open": 4000,
    "high": 4200,
    "low": 3900,
    "foreignBuy": 0,
    "foreignSell": 0,
    "foreignRemain": 0,
    "TOTAL_OFFER_QTTY": 5653700,
    "TOTAL_BID_QTTY": 5361100,
    "PT_MATCH_PRICE": 0,
    "PT_TOTAL_TRADED_QTTY": 0,
    "PT_TOTAL_TRADED_VALUE": 0,
    "Status": "0|0|0|0|0",
    "TotalListingQtty": "117900000",
    "changePercent": 5.128205128205128,
    "exchange": "UPCOM",
    "ts": 1726732912709,
    "s": 2648,
    "kid": "1726732912709-7939220660292628472"
},
{
    "symbol": "AAM",
    "StockId": "9",
    "FullName": "Công ty cổ phần Thủy sản Mekong",
    "tradingdate": "19/09/2024",
    "FloorCode": "10",
    "StockType": "2",
    "ceiling": 7810,
    "floor": 6790,
    "reference": 7300,
    "bidPrice3": 7250,
    "bidVol3": 27000,
    "bidPrice2": 7260,
    "bidVol2": 500,
    "bidPrice1": "7270",
    "bidVol1": 1000,
    "closePrice": 7600,
    "closeVol": 400,
    "change": 300,
    "offerPrice1": "7600",
    "offerVol1": 400,
    "offerPrice2": 7700,
    "offerVol2": 600,
    "offerPrice3": 7750,
    "offerVol3": 1000,
    "totalTrading": 4000,
    "totalTradingValue": 29650000,
    "averagePrice": 7412.5,
    "open": 7300,
    "high": 7600,
    "low": 7300,
    "foreignBuy": 0,
    "foreignSell": 0,
    "foreignRemain": 5948364,
    "foreignRoom": 6049741,
    "Status": "|||||||H",
    "underlyingSymbol": "",
    "IssuerName": "",
    "CoveredWarrantType": "",
    "MaturityDate": "",
    "ExercisePrice": "0",
    "ListedShare": "12346411",
    "FundType": "S",
    "changePercent": 4.10958904109589,
    "exchange": "HOSE",
    "ts": 1726734572380,
    "s": 42,
    "kid": "17267345723801997990590753554301"
},
  // Có thể thêm nhiều dữ liệu khác
];

// Endpoint API để lấy dữ liệu
// Endpoint API để lấy dữ liệu
app.get('/stocks', (req, res) => {
  const modifiedStockData = stockData.map(stock => ({
    symbol: stock.symbol,
    FullName: stock.FullName,
    bidPrice3: stock.bidPrice3,
    bidVol3: stock.bidVol3,
  }));
  res.json(modifiedStockData);
});


// Endpoint API để cập nhật trạng thái yêu thích
app.post('/stocks/:symbol/favorite', (req, res) => {
  const symbol = req.params.symbol;
  const stock = stockData.find(stock => stock.symbol === symbol);

  if (stock) {
    stock.isFavorite = !stock.isFavorite;
    res.json({ message: 'Cập nhật trạng thái yêu thích thành công', stock });
  } else {
    res.status(404).json({ message: 'Không tìm thấy mã chứng khoán' });
  }
});

app.listen(port, () => {
  console.log(`Server chạy trên cổng ${port}`);
});
